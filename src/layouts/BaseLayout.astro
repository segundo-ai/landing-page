---
import "@/styles/starwind.css";
import { site } from "@/config/site";
import { ui } from "@/config/i18n";
import { defaultLang } from "@/config/i18n";
import type { Language } from "@/config/i18n";

interface Props {
  title?: string;
  description?: string;
  lang?: Language;
}

const { title = site.name, description = site.description, lang: langProp } = Astro.props;
const lang = langProp || defaultLang;

// Serialize translations for client-side use
const translationsJSON = JSON.stringify(ui);
---

<!doctype html>
<html lang={lang}>
  <head>
    <meta charset="UTF-8" />
    <meta name="description" content={description} />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Preload critical fonts for landing screen -->
    <link rel="preload" href="/fonts/satoshi/Satoshi-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous" />
    <link rel="preload" href="/fonts/satoshi/Satoshi-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous" />
    <link rel="preload" href="/fonts/nohemi/Nohemi-Regular.woff" as="font" type="font/woff" crossorigin="anonymous" />
    <link rel="preload" href="/fonts/nohemi/Nohemi-ExtraLight.woff" as="font" type="font/woff" crossorigin="anonymous" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>{title}</title>
  </head>
  <body>
    <slot />
    <script set:html={`window.__TRANSLATIONS__ = ${translationsJSON};`}>
    </script>
    <!-- 
      Note: Using <script> (not type="module") so Astro processes @/ path aliases.
      type="module" would bypass Astro's bundler and cause module resolution errors.
    -->
    <script>
      import { initScrollAnimations } from '@/utils/dom/scroll-animations';
      
      // Initialize scroll animations
      if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", initScrollAnimations);
      } else {
        initScrollAnimations();
      }
    </script>
  </body>
</html>

